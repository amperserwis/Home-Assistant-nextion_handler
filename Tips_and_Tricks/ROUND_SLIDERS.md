# 2) Dynamic Round Sliders on Nextion Devices (documentation in progress ...)

The [first tips and tricks page](/Tips_and_Tricks/NEXTION_GESTURES.md) showed different ways of implementing gestures on Nextion devices.  The realtime touch information on the 'swipe and press' gestures page of the demo HMI file started to give some idea of the opportunities for being more creative in using that data during data events.

Here, as examples to illustrate some of that potential, are two implementations of a **round/circular slider** that use that information in different ways.
Both examples are included on a single page in the demo HMI file in this folder, and you press the button next to the slider to toggle between the different `Timer`s used to process the gestures.  The 'swipe and press' gestures from the the previous page are also implemented on the circular sliders page (so `tc0` selects which gesture processor to use based on which UI component is initially touched).  You can get a good feeling for how these sliders work by using the HMI file in the Nextion Editor simulator.  The main differences when using this on a physical device are: **1)** the slider might be a bit small for your use case (although you can get very fine control by using the whole screen once you have started the round slider - you don't have to keep your finger on the visible arc); **2)** there will be some screen flicker on the physical device and you need to take some steps to reduce this (to demonstrate this the first 'progressive arc' approach described below only updates UI elements when a step change in value occurs, while 'moving dot' implementation updates whever touch movement is detected).

## Progressive arc slider (xpic, ATAN2)
The 'progressive' slider uses arctan (of the current touch coordinates relative to the centre of the slider arc) to determine which part of the round the (high precision) slider scale the current touch location should be associated with.  It then divides the slider scale value up into steps and uses the current 'step' value to select which of a series of slider images to crop, using the Nextion `xpic` instruction, to visualise slider movements.  This method allows the greatest control over the style of the visual feedback on the circular slider, but requires a separate image to be created for each 'step' in slider value to be visually represented (although the returned slider scale value can be returned with greater precision/fine steps).

On the slider testing page in the demo HMI file, the 'Gesture info' (on the left) shows the realtime touch information for 'normal' gestures (that start off the sliders).  The 'Slider info' (on the right) shows the realtime touch coordinates for round slider interactions (`x`, `y`) and the deltas from the centre of the slider arc (`dx`, `dy`).  The current slider scale arctan value (0 ... 9999 range) is also shown, together with which otant (numbered 1..8 clockwise from 3 o'clock) and quadrant (A..D: from pairs of octants 1&8, 2&3, 4&5, 6&7 respectively) is currently being used in the arctan subroutine.

![Edge swipe demo page](/Tips_and_Tricks/images/ROUND-SLIDER_Progressive-Anim.gif)

## Moving dot slider (cirs, ATAN2, SQRT)
The 'moving dot' approach is more fucntionally versatile, but more restricted in visual representation/customisation.  It uses a static slider background on which a dot is drawn to represent the scale position for the current touch location.  As above it uses arctan (of the current touch coordinates relative to the centre of the slider arc) to determine slider scale value.  The visualisation uses a square root function to rescale the current touch location distance from the centre of the slider arc back onto the radius of the arc, and then draws a filled circle there with the Nextion `cirs` instruction.  As before, the calculation and precision of the returned slider scale value are calculated separately from the visual represenation.  It is up to the coding to determine how many visual steps are used (to reduce screen flicker) and to what extent the visual steps reflect how the (high precision) slider scale value is applied to step changes in the final returned value (e.g. the temperature in the middle of the slider).

On the slider testing page in the demo HMI file, realtime information is given on touch events as they are processed.  When the 'moving dot slider' is in use, the 'Slider info' (on the right) shows the realtime touch coordinates for round slider interactions (`x`, `y`) and the deltas from the centre of the slider arc (`dx`, `dy`) and the current slider scale arctan value (0 ... 9999 range), while the 'Gesture info' table (on the right) is used to show post-processed touch coordinates _after they have been radially rescaled back onto the round slider arc_.

![Edge swipe demo page](/Tips_and_Tricks/images/ROUND-SLIDER_Moving-Dot-Anim.gif)
